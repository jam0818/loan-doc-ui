# システム連携テスト チェックリスト

## テスト実行方法

```bash
# 全テストを実行
bun run test:e2e

# 特定のテストファイルを実行
bunx playwright test e2e/auth.spec.ts

# UIモードで実行（デバッグ用）
bunx playwright test --ui

# レポートを確認
bunx playwright show-report
```

---

## 1. 認証機能テスト (`auth.spec.ts`)

### 操作フロー樹形図

```
[ユーザー状態]
├── 未認証状態
│   ├── /login にアクセス
│   │   ├── ログインページ表示
│   │   ├── フォーム入力
│   │   │   ├── 有効な認証情報 → ログイン成功
│   │   │   ├── 無効な認証情報 → エラー表示
│   │   │   └── 空のフィールド → ボタン無効
│   │   └── パスワード表示/非表示切替
│   └── /（メイン）にアクセス → /login にリダイレクト
│
└── 認証済み状態
    ├── /login にアクセス → / にリダイレクト
    ├── ユーザー名表示
    ├── ログアウト → /login に戻る
    └── セッション永続化（LocalStorage）
```

### テスト一覧（13件）

| # | カテゴリ | テスト名 | 状態 |
|---|---------|---------|------|
| 1.1 | 未認証-ページ | ログインページ表示 | [ ] |
| 1.2 | 未認証-ページ | 未認証リダイレクト | [ ] |
| 1.3 | 未認証-入力 | ログイン成功 | [ ] |
| 1.4 | 未認証-入力 | ログイン失敗エラー | [ ] |
| 1.5 | 未認証-入力 | 空フィールド無効 | [ ] |
| 1.6 | 未認証-入力 | パスワード表示切替 | [ ] |
| 1.7 | 認証済み | ログイン済みリダイレクト | [ ] |
| 1.8 | 認証済み | ユーザー名表示 | [ ] |
| 1.9 | 認証済み | ログアウト | [ ] |
| 1.10 | 認証済み | ログアウト後アクセス不可 | [ ] |
| 1.11 | 永続化 | リロード後維持 | [ ] |
| 1.12 | 永続化 | トークン保存 | [ ] |
| 1.13 | 永続化 | ログアウト時削除 | [ ] |

---

## 2. ドキュメントCRUDテスト (`documents.spec.ts`)

### 操作フロー樹形図

```
[ドキュメント操作]
├── 一覧表示
│   ├── ドロップダウンに一覧表示
│   └── 空の場合 → 選択促進メッセージ
│
├── 選択
│   ├── ドロップダウンから選択
│   │   ├── タイトル表示
│   │   ├── フィールド一覧表示
│   │   │   ├── フィールドあり → 名前・内容表示
│   │   │   └── フィールドなし → 「フィールドがありません」
│   │   └── 編集/削除ボタン有効化
│   └── 選択解除（クリア）
│       └── 編集/削除ボタン無効化
│
├── 作成 (Create)
│   ├── ダイアログ表示（+ボタン）
│   ├── タイトル入力
│   │   ├── 有効な値 → 保存ボタン有効
│   │   └── 空 → 保存ボタン無効
│   ├── フィールド追加/削除
│   │   ├── フィールド追加ボタン
│   │   ├── フィールド名入力
│   │   ├── フィールド内容入力
│   │   └── フィールド削除
│   ├── 保存 → 一覧に追加、自動選択
│   └── キャンセル → ダイアログ閉じる
│
├── 更新 (Update)
│   ├── 編集ダイアログ表示（鉛筆ボタン）
│   ├── タイトル変更
│   ├── フィールド追加/編集/削除
│   ├── 保存 → 反映
│   └── キャンセル
│
└── 削除 (Delete)
    ├── 確認ダイアログ表示（ゴミ箱ボタン）
    │   ├── ドキュメント名表示
    │   └── 「取り消せません」警告
    ├── 削除実行 → 一覧から消える
    └── キャンセル → ダイアログ閉じる
```

### テスト一覧（15件）

| # | カテゴリ | テスト名 | 状態 |
|---|---------|---------|------|
| 2.1 | 一覧 | ドロップダウンに一覧表示 | [ ] |
| 2.2 | 一覧 | 未選択時メッセージ | [ ] |
| 2.3 | 選択 | ドキュメント選択 | [ ] |
| 2.4 | 選択 | タイトル表示 | [ ] |
| 2.5 | 選択 | フィールド一覧表示 | [ ] |
| 2.6 | 選択 | フィールドなしメッセージ | [ ] |
| 2.7 | 選択 | 選択解除 | [ ] |
| 2.8 | 作成 | ダイアログ表示 | [ ] |
| 2.9 | 作成 | タイトル空で保存不可 | [ ] |
| 2.10 | 作成 | フィールド追加・削除 | [ ] |
| 2.11 | 作成 | 作成成功・自動選択 | [ ] |
| 2.12 | 更新 | 編集ダイアログ表示 | [ ] |
| 2.13 | 更新 | タイトル・フィールド変更 | [ ] |
| 2.14 | 削除 | 確認ダイアログ表示 | [ ] |
| 2.15 | 削除 | 削除実行・キャンセル | [ ] |

---

## 3. プロンプトCRUDテスト (`prompts.spec.ts`)

### 操作フロー樹形図

```
[プロンプト操作]
├── 前提条件
│   └── ドキュメントが選択されていること
│
├── 一覧表示
│   ├── ドロップダウンに一覧表示
│   ├── ドキュメント未選択 → ドロップダウン無効
│   └── 空の場合 → 選択促進メッセージ
│
├── 選択
│   ├── ドロップダウンから選択
│   │   └── プロンプト編集エリア表示
│   └── 選択解除
│
├── モード切替
│   ├── 生成用モード（デフォルト）
│   └── 修正用モード → 個別再生成ボタン表示
│
├── プロンプトタイプ
│   ├── 全フィールド共通 (all)
│   │   └── 単一テキストエリア表示
│   └── 個別フィールド (each)
│       ├── フィールドごとのパネル表示
│       ├── 折りたたみ/展開
│       ├── 初期状態: 全展開
│       └── 設定済みチップ表示
│
├── 作成 (Create)
│   ├── ダイアログ表示
│   ├── タイトル入力
│   ├── プロンプトタイプ選択
│   │   ├── 全フィールド共通
│   │   └── 個別フィールド
│   ├── 保存
│   └── キャンセル
│
├── 更新 (Update)
│   ├── プロンプト内容編集
│   │   ├── 全フィールド共通 → テキストエリア編集
│   │   └── 個別フィールド → 各フィールドのテキストエリア編集
│   └── 自動保存 or 保存ボタン
│
└── 削除 (Delete)
    ├── 確認ダイアログ表示
    ├── 削除実行
    └── キャンセル
```

### テスト一覧（18件）

| # | カテゴリ | テスト名 | 状態 |
|---|---------|---------|------|
| 3.1 | 前提 | ドキュメント未選択で無効 | [ ] |
| 3.2 | 一覧 | ドロップダウンに一覧表示 | [ ] |
| 3.3 | 一覧 | 未選択時メッセージ | [ ] |
| 3.4 | 選択 | プロンプト選択 | [ ] |
| 3.5 | 選択 | 編集エリア表示 | [ ] |
| 3.6 | モード | 生成用モード表示 | [ ] |
| 3.7 | モード | 修正用モード切替 | [ ] |
| 3.8 | モード | 個別再生成ボタン表示 | [ ] |
| 3.9 | タイプ | 全フィールド共通表示 | [ ] |
| 3.10 | タイプ | 個別フィールドパネル表示 | [ ] |
| 3.11 | タイプ | 折りたたみ/展開 | [ ] |
| 3.12 | タイプ | 初期状態全展開 | [ ] |
| 3.13 | タイプ | 設定済みチップ表示 | [ ] |
| 3.14 | 作成 | ダイアログ表示 | [ ] |
| 3.15 | 作成 | タイプ選択・作成成功 | [ ] |
| 3.16 | 更新 | プロンプト内容編集 | [ ] |
| 3.17 | 削除 | 確認ダイアログ表示 | [ ] |
| 3.18 | 削除 | 削除実行・キャンセル | [ ] |

---

## 4. LLM生成機能テスト (`generation.spec.ts`)

### 操作フロー樹形図

```
[LLM生成操作]
├── 前提条件確認
│   ├── ドキュメント未選択 → 生成ボタン無効
│   ├── プロンプト未選択 → 生成ボタン無効
│   └── 両方選択 → 生成ボタン有効
│
├── 表示モード切替
│   ├── 生成前モード
│   │   └── ドキュメント内容（読み取り専用）
│   └── 生成後モード
│       └── 生成結果（編集可能）
│
├── 一括生成
│   ├── 生成ボタンクリック
│   ├── 生成中状態
│   │   ├── ローディング表示
│   │   ├── 生成中フィールド表示
│   │   └── ボタン無効化
│   ├── 生成成功
│   │   ├── 自動的に「生成後」モードに切替
│   │   └── 結果表示
│   └── 生成エラー
│       └── エラーメッセージ表示
│
├── 個別再生成（修正モード時）
│   ├── 各フィールドの再生成ボタン
│   ├── 生成中状態（該当フィールドのみ）
│   └── 結果反映
│
└── 生成結果操作
    ├── 生成後コンテンツ編集
    └── コピー/エクスポート（将来機能）
```

### テスト一覧（14件）

| # | カテゴリ | テスト名 | 状態 |
|---|---------|---------|------|
| 4.1 | 前提 | ドキュメント未選択で無効 | [ ] |
| 4.2 | 前提 | プロンプト未選択で無効 | [ ] |
| 4.3 | 前提 | 両方選択で有効 | [ ] |
| 4.4 | 表示 | 生成前モード表示 | [ ] |
| 4.5 | 表示 | 生成後モード表示 | [ ] |
| 4.6 | 表示 | モード切替 | [ ] |
| 4.7 | 一括 | 生成ボタンクリック | [ ] |
| 4.8 | 一括 | 生成中ローディング | [ ] |
| 4.9 | 一括 | 生成中ボタン無効 | [ ] |
| 4.10 | 一括 | 生成成功・モード切替 | [ ] |
| 4.11 | 一括 | 生成エラー表示 | [ ] |
| 4.12 | 個別 | 再生成ボタン表示（修正モード） | [ ] |
| 4.13 | 個別 | 個別フィールド再生成 | [ ] |
| 4.14 | 結果 | 生成後コンテンツ編集 | [ ] |

---

## 5. 結合テスト (`integration.spec.ts`)

### 操作フロー樹形図

```
[エンドツーエンドフロー]
├── 完全ワークフロー
│   ├── 1. ログイン
│   ├── 2. ドキュメント作成
│   ├── 3. プロンプト作成
│   ├── 4. LLM生成実行
│   └── 5. 結果確認
│
├── 画面遷移
│   ├── 認証状態維持
│   ├── ログアウト→再ログイン
│   └── リロード後の状態復元
│
├── コンポーネント連携
│   ├── ドキュメント選択 → プロンプト有効化
│   ├── ドキュメント切替 → プロンプトリセット確認
│   ├── プロンプト選択 → 生成ボタン有効化
│   └── モード変更の連動
│
├── レイアウト
│   └── 3カラムレイアウト表示
│
└── エラー処理
    ├── APIエラー時の表示
    ├── ネットワークエラー
    └── タイムアウト
```

### テスト一覧（12件）

| # | カテゴリ | テスト名 | 状態 |
|---|---------|---------|------|
| 5.1 | フロー | 完全ワークフロー実行 | [ ] |
| 5.2 | 遷移 | ログアウト→再ログイン | [ ] |
| 5.3 | 遷移 | リロード後状態維持 | [ ] |
| 5.4 | 連携 | ドキュメント選択→プロンプト有効 | [ ] |
| 5.5 | 連携 | ドキュメント切替→プロンプトリセット | [ ] |
| 5.6 | 連携 | プロンプト選択→生成有効 | [ ] |
| 5.7 | 連携 | モード変更連動 | [ ] |
| 5.8 | レイアウト | 3カラムレイアウト表示 | [ ] |
| 5.9 | エラー | APIエラー表示 | [ ] |
| 5.10 | エラー | ネットワークエラー | [ ] |
| 5.11 | エラー | タイムアウト処理 | [ ] |
| 5.12 | エラー | 無効認証エラー | [ ] |

---

## テストカバレッジサマリー

| カテゴリ | 変更前 | 変更後 |
|---------|-------|-------|
| 認証機能 | 4 | **13** |
| ドキュメントCRUD | 9 | **15** |
| プロンプトCRUD | 10 | **18** |
| LLM生成 | 7 | **14** |
| 結合テスト | 6 | **12** |
| **合計** | **36** | **72** |

# システム連携テスト チェックリスト

## テスト実行方法

```bash
# 全テストを実行
bun run test:e2e

# 特定のテストファイルを実行
bunx playwright test e2e/auth.spec.ts

# UIモードで実行（デバッグ用）
bunx playwright test --ui

# レポートを確認
bunx playwright show-report
```

---

## 1. 認証機能テスト (`auth.spec.ts`)

### 操作フロー樹形図

```
[ユーザー状態]
├── 未認証状態
│   ├── /login にアクセス
│   │   ├── ログインページ表示
│   │   ├── フォーム入力
│   │   │   ├── 有効な認証情報 → ログイン成功
│   │   │   ├── 無効な認証情報 → エラー表示
│   │   │   └── 空のフィールド → ボタン無効
│   │   └── パスワード表示/非表示切替
│   └── /（メイン）にアクセス → /login にリダイレクト
│
└── 認証済み状態
    ├── /login にアクセス → / にリダイレクト
    ├── ユーザー名表示
    ├── ログアウト → /login に戻る
    └── セッション永続化（LocalStorage）
```

### 未認証状態 - ログインページ
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 1.1 | ログインページ表示 | タイトル・入力欄・ボタンが表示 | [ ] |
| 1.2 | 未認証リダイレクト | メインにアクセス→ログインへ | [ ] |

### 未認証状態 - フォーム入力
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 1.3 | ログイン成功 | 有効な認証情報でメイン画面へ | [ ] |
| 1.4 | ログイン失敗 | 無効な認証でエラー表示 | [ ] |
| 1.5 | 空フィールド無効 | 空欄時はボタン無効 | [ ] |
| 1.6 | パスワード表示切替 | 目アイコンで表示/非表示 | [ ] |

### 認証済み状態
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 1.7 | ログイン済みリダイレクト | /login→/にリダイレクト | [ ] |
| 1.8 | ユーザー名表示 | ヘッダーにユーザー名 | [ ] |
| 1.9 | ログアウト | /loginに戻る | [ ] |
| 1.10 | ログアウト後アクセス不可 | 保護ページにアクセス不可 | [ ] |

### セッション永続化
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 1.11 | リロード後維持 | 認証状態が維持される | [ ] |
| 1.12 | トークン保存 | LocalStorageに保存 | [ ] |
| 1.13 | ログアウト時削除 | トークンが削除される | [ ] |

---

## 2. ドキュメントCRUDテスト (`documents.spec.ts`)

### Create（作成）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 2.1 | ダイアログ表示 | 新規作成ダイアログが開く | [ ] |
| 2.2 | 作成成功 | タイトル・フィールドを入力して作成 | [ ] |
| 2.3 | バリデーション | 空タイトルでは作成不可 | [ ] |

### Read（読み取り）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 2.4 | フィールド表示 | 選択時にフィールド一覧表示 | [ ] |
| 2.5 | 未選択時 | 選択促進メッセージ表示 | [ ] |

### Update（更新）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 2.6 | タイトル変更 | 編集ダイアログからタイトル変更 | [ ] |

### Delete（削除）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 2.7 | 確認ダイアログ | 削除確認ダイアログ表示 | [ ] |
| 2.8 | キャンセル | キャンセルで削除中断 | [ ] |
| 2.9 | 削除実行 | 実行後にドキュメント消える | [ ] |

---

## 3. プロンプトCRUDテスト (`prompts.spec.ts`)

### Create（作成）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 3.1 | ダイアログ表示 | 新規作成ダイアログが開く | [ ] |
| 3.2 | 作成成功 | タイトル・タイプを設定して作成 | [ ] |
| 3.3 | 全フィールド共通 | タイプ選択が機能する | [ ] |
| 3.4 | 個別フィールド | タイプ選択が機能する | [ ] |

### Read（読み取り）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 3.5 | 内容表示 | 選択時にプロンプト内容表示 | [ ] |
| 3.6 | モード切替 | 生成用/修正用モード切替 | [ ] |
| 3.7 | 折りたたみ | 個別フィールドの折りたたみ | [ ] |

### Update（更新）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 3.8 | 内容編集 | プロンプト内容を編集保存 | [ ] |

### Delete（削除）
| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 3.9 | 確認ダイアログ | 削除確認ダイアログ表示 | [ ] |
| 3.10 | キャンセル | キャンセルで削除中断 | [ ] |

---

## 4. LLM生成機能テスト (`generation.spec.ts`)

| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 4.1 | ドキュメント未選択 | 生成ボタン無効 | [ ] |
| 4.2 | プロンプト未選択 | 生成ボタン無効 | [ ] |
| 4.3 | 両方選択時 | 生成ボタン有効 | [ ] |
| 4.4 | 一括生成 | 生成が開始される | [ ] |
| 4.5 | 生成前表示 | 生成前コンテンツ表示 | [ ] |
| 4.6 | 個別再生成 | 修正モードで再生成ボタン | [ ] |
| 4.7 | 生成後表示 | 生成後エリア存在 | [ ] |

---

## 5. 結合テスト (`integration.spec.ts`)

| # | テスト名 | 説明 | 状態 |
|---|---------|------|------|
| 5.1 | 完全フロー | 認証→ドキュメント→プロンプト→生成 | [ ] |
| 5.2 | 再ログイン | ログアウト後に再ログイン | [ ] |
| 5.3 | ドキュメント切替 | 切替時にプロンプトリセット | [ ] |
| 5.4 | レイアウト確認 | 3カラムレイアウト表示 | [ ] |
| 5.5 | 認証エラー | 無効認証でエラー表示 | [ ] |
| 5.6 | APIエラー | 接続エラー時の表示 | [ ] |

---

## テストカバレッジサマリー

| カテゴリ | テスト数 |
|---------|---------|
| 認証機能 | 13 |
| ドキュメントCRUD | 9 |
| プロンプトCRUD | 10 |
| LLM生成 | 7 |
| 結合テスト | 6 |
| **合計** | **45** |
